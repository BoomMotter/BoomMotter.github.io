<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ekb-Luxury Hotel</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header>
        <nav>
            <div class="logo"><font id="logot">Ekb-Luxury Hotel</font></div>
            <ul class="nav-links">
                <li><a href="#home">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="#about">–û –Ω–∞—Å</a></li>
                <li><a href="#services">–£—Å–ª—É–≥–∏</a></li>
                <li><a href="#rooms">–ù–æ–º–µ—Ä–∞</a></li>
                <li><a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
            </ul>
        </nav>
    </header>

    <!-- –ì–ª–∞–≤–Ω—ã–π –±–∞–Ω–Ω–µ—Ä -->
    <section id="home" class="hero">
        <div class="container">
            <h1>–ü—Ä–∏–º–µ—Ä –±–∏–∑–µ—Å - –ì–æ—Å—Ç–∏–Ω–∏—Ü–∞ üõé </h1>
            <p>–ü–æ–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ –º–∏—Ä –∫–æ–º—Ñ–æ—Ä—Ç–∞ –∏ –±–µ–∑—É–ø—Ä–µ—á–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –≤ –Ω–∞—à–µ–º –ø—è—Ç–∏–∑–≤–µ–∑–¥–æ—á–Ω–æ–º –æ—Ç–µ–ª–µ</p>
            <a href="#rooms" class="btn">–í—ã–±—Ä–∞—Ç—å –Ω–æ–º–µ—Ä</a>
        </div>
    </section>

    <!-- –û –∫–æ–º–ø–∞–Ω–∏–∏ -->
    <section id="about">
        <div class="container">
            <h2>–û –Ω–∞—à–µ–º –æ—Ç–µ–ª–µ</h2>
            <div class="about-content">
                <div>
                    <p>Ekb-Luxury Hotel - —ç—Ç–æ –æ–∞–∑–∏—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞ –∏ –∏–∑—ã—Å–∫–∞–Ω–Ω–æ—Å—Ç–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–∞. –ú—ã —Å–æ—á–µ—Ç–∞–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å —Ç–µ–ø–ª—ã–º –≥–æ—Å—Ç–µ–ø—Ä–∏–∏–º—Å—Ç–≤–æ–º, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≤–∞—à –æ—Ç–¥—ã—Ö –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–º.</p>
                    <p>–ù–∞—à –æ—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 2010 –≥–æ–¥–∞ –∏ –∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è —Å—Ç–∞–ª –ª—é–±–∏–º—ã–º –º–µ—Å—Ç–æ–º –æ—Ç–¥—ã—Ö–∞ –∫–∞–∫ –¥–ª—è –¥–µ–ª–æ–≤—ã—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤, —Ç–∞–∫ –∏ –¥–ª—è —Ç—É—Ä–∏—Å—Ç–æ–≤. –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º 150 —Ä–æ—Å–∫–æ—à–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤, —Ä–µ—Å—Ç–æ—Ä–∞–Ω –≤—ã—Å–æ–∫–æ–π –∫—É—Ö–Ω–∏ –∏ —Å–ø–∞-—Ü–µ–Ω—Ç—Ä –º–∏—Ä–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è.</p>
                    <p>–ù–∞—à–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</p>
                    <ul style="margin-left: 20px; margin-bottom: 20px;">
                        <li>–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞</li>
                        <li>–ù–æ–º–µ—Ä–∞ —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ –Ω–∞ –≥–æ—Ä–æ–¥</li>
                        <li>–ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤</li>
                        <li>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü-–∑–∞–ª</li>
                        <li>SPA-—Ü–µ–Ω—Ç—Ä —Å –±–∞—Å—Å–µ–π–Ω–æ–º –∏ —Å–∞—É–Ω–æ–π</li>
                    </ul>
                </div>
                <div class="about-img">
                    <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3" alt="Ekb-Luxury Hotel">
                </div>
            </div>
        </div>
    </section>

    <!-- –£—Å–ª—É–≥–∏ -->
    <section id="services" class="services">
        <div class="container">
            <h2>–ù–∞—à–∏ —É—Å–ª—É–≥–∏</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('auth-code')">üõéÔ∏è</div>
                    <h3>–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤</h3>
                    <p>–ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, —É–±–æ—Ä–∫–∞ –∏ –∑–∞–±–æ—Ç–∞ –æ –≤–∞—à–µ–º –∫–æ–º—Ñ–æ—Ä—Ç–µ</p>
                </div>
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('menu-code')">üçΩÔ∏è</div>
                    <h3>–†–µ—Å—Ç–æ—Ä–∞–Ω</h3>
                    <p>–ó–∞–≤—Ç—Ä–∞–∫–∏ "—à–≤–µ–¥—Å–∫–∏–π —Å—Ç–æ–ª" –∏ –∏–∑—ã—Å–∫–∞–Ω–Ω—ã–µ –±–ª—é–¥–∞ –æ—Ç –Ω–∞—à–µ–≥–æ —à–µ—Ñ-–ø–æ–≤–∞—Ä–∞</p>
                </div>
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('password-code')">üèä</div>
                    <h3>SPA –∏ –±–∞—Å—Å–µ–π–Ω</h3>
                    <p>–†–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –∫—Ä—ã—Ç—ã–π –±–∞—Å—Å–µ–π–Ω —Å –ø–æ–¥–æ–≥—Ä–µ–≤–æ–º</p>
                </div>
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('users-code')">üíº</div>
                    <h3>–ë–∏–∑–Ω–µ—Å-—É—Å–ª—É–≥–∏</h3>
                    <p>–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü-–∑–∞–ª—ã, –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä –∏ –≤—Å–µ –¥–ª—è –¥–µ–ª–æ–≤—ã—Ö –≤—Å—Ç—Ä–µ—á</p>
                </div>
            </div>
        </div>
    </section>

    <!-- –ì–∞–ª–µ—Ä–µ—è –Ω–æ–º–µ—Ä–æ–≤ -->
    <section id="rooms">
        <div class="container">
            <h2>–ù–∞—à–∏ –Ω–æ–º–µ—Ä–∞</h2>
            <div class="gallery-grid">
                <div class="gallery-item">
                    <img src="https://horseka.ru/wp-content/uploads/2024/07/Horseka_Number2.jpg" alt="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–æ–º–µ—Ä">
                    <div class="room-overlay">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–æ–º–µ—Ä</div>
                </div>
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1592229505726-ca121723b8ef?ixlib=rb-4.0.3" alt="–î–µ–ª—é–∫—Å –Ω–æ–º–µ—Ä">
                    <div class="room-overlay">–ù–æ–º–µ—Ä –î–µ–ª—é–∫—Å</div>
                </div>
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?ixlib=rb-4.0.3" alt="–õ—é–∫—Å –Ω–æ–º–µ—Ä">
                    <div class="room-overlay">–õ—é–∫—Å –Ω–æ–º–µ—Ä</div>
                </div>
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1578683010236-d716f9a3f461?ixlib=rb-4.0.3" alt="–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏–π –ª—é–∫—Å">
                    <div class="room-overlay">–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏–π –ª—é–∫—Å</div>
                </div>
            </div>
        </div>
    </section>

    <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
    <section id="contact" style="background: linear-gradient(to right, var(--primary), var(--dark)); color: white;">
        <div class="container">
            <h2 style="color: white;">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
            <p>–ó–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –Ω–æ–º–µ—Ä –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É</p>
            <div style="margin-top: 30px;">
                <p><strong>–ê–¥—Ä–µ—Å:</strong> –≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, 24</p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +7 (343) 222-33-44</p>
                <p><strong>Email:</strong> booking@ekb-luxury.ru</p>
            </div>
            <a href="#" class="btn" style="margin-top: 30px; background: white; color: var(--primary);">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</a>
        </div>
    </section>


    <div class="hidden-code" id="auth-code">
        Private Sub Form_Load()
    Dim conn As Object
    Dim rs As Object
    Dim strConn As String
    Dim strSQL As String
    Dim –¢–µ–∫—É—â–∞—è_–¥–∞—Ç–∞ As Date
    Dim –õ–æ–≥–∏–Ω As String
    Dim –î–∞—Ç–∞_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ As Date
    
    –¢–µ–∫—É—â–∞—è_–¥–∞—Ç–∞ = Date
    
    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"
    
    Set conn = CreateObject("ADODB.Connection")
    conn.Open strConn
    
    strSQL = "SELECT login, last_auth_date FROM [users] WHERE last_auth_date IS NOT NULL"
    
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 3
    
    Do While Not rs.EOF
        –õ–æ–≥–∏–Ω = rs.Fields("login").Value
        –î–∞—Ç–∞_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ = rs.Fields("last_auth_date").Value
        
        If –¢–µ–∫—É—â–∞—è_–¥–∞—Ç–∞ - –î–∞—Ç–∞_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ > 30 Then
            Dim updateSQL As String
            updateSQL = "UPDATE [users] SET is_blocked = 1 WHERE login = '" & Replace(–õ–æ–≥–∏–Ω, "'", "''") & "'"
            conn.Execute updateSQL
        End If
        
        rs.MoveNext
    Loop
    
    rs.Close
    conn.Close
    
    Set rs = Nothing
    Set conn = Nothing
End Sub
Private Sub –í—Ö–æ–¥_Click()
    Dim conn As Object
    Dim rs As Object
    Dim strConn As String
    Dim strSQL As String
    Dim –õ–æ–≥–∏–Ω As String
    Dim –ü–∞—Ä–æ–ª—å As String
    Dim –ü—Ä–∞–≤–∞_–¥–æ—Å—Ç—É–ø–∞ As String
    Dim –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ As Boolean
    Dim –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞ As Integer
    Dim –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è As Boolean

    –õ–æ–≥–∏–Ω = Nz(Me.–õ–æ–≥–∏–Ω.Value, "")
    –ü–∞—Ä–æ–ª—å = Nz(Me.–ü–∞—Ä–æ–ª—å.Value, "")

    If Trim(–õ–æ–≥–∏–Ω) = "" Or Trim(–ü–∞—Ä–æ–ª—å) = "" Then
        MsgBox "–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å"
        Exit Sub
    End If

    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"

    Set conn = CreateObject("ADODB.Connection")
    conn.ConnectionString = strConn
    conn.Open

    strSQL = "SELECT * FROM [users] WHERE login = '" & –õ–æ–≥–∏–Ω & "'"

    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 3

    If rs.EOF Then
        MsgBox "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω"
    Else
        –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ = Nz(rs("is_blocked"), False)
        If –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Then
            MsgBox "–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."
            rs.Close: conn.Close
            Exit Sub
        End If

        If rs("password") = –ü–∞—Ä–æ–ª—å Then
            –¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω = –õ–æ–≥–∏–Ω
            rs("login_attempts") = 0
            rs("last_auth_date") = Date
            –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è = Nz(rs("account_confirmed"), False)
            –ü—Ä–∞–≤–∞_–¥–æ—Å—Ç—É–ø–∞ = rs("access_level")

            rs.Update

            MsgBox "–í—ã —É—Å–ø–µ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª–∏—Å—å"
            If Not –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è Then
                MsgBox "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º."
                DoCmd.OpenForm "–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è"
            End If

            Select Case –ü—Ä–∞–≤–∞_–¥–æ—Å—Ç—É–ø–∞
                Case "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"
                    DoCmd.OpenForm "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
                Case "–°–æ—Ç—Ä—É–¥–Ω–∏–∫"
                    DoCmd.OpenForm "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"
                Case "–ö–ª–∏–µ–Ω—Ç"
                    DoCmd.OpenForm "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∫–ª–∏–µ–Ω—Ç–∞"
                Case Else
                    MsgBox "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
            End Select

            DoCmd.Close acForm, Me.Name
        Else
            –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞ = Nz(rs("login_attempts"), 0) + 1
            rs("login_attempts") = –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞

            If –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞ >= 3 Then
                rs("is_blocked") = True
                MsgBox "–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–∑-–∑–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫."
            Else
                MsgBox "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: " & (3 - –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞)
            End If

            rs.Update
        End If
    End If

    rs.Close
    conn.Close
    Set rs = Nothing
    Set conn = Nothing
End Sub
Private Sub –í—ã—Ö–æ–¥_Click()
    Dim –æ—Ç–≤–µ—Ç As Integer
    –æ—Ç–≤–µ—Ç = MsgBox("–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?", vbYesNo)
    
    If –æ—Ç–≤–µ—Ç = vbYes Then
        DoCmd.Quit
    End If
End Sub

    </div>

    <div class="hidden-code" id="menu-code">
        Private Sub –í—ã—Ö–æ–¥_Click()
    Dim –æ—Ç–≤–µ—Ç As Integer
    –æ—Ç–≤–µ—Ç = MsgBox("–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?", vbYesNo)
    
    If –æ—Ç–≤–µ—Ç = vbYes Then
        DoCmd.Quit
    End If
End Sub
Private Sub –°–º–µ–Ω–∞–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è_Click()
    Dim frm As AccessObject

    For Each frm In Application.CurrentProject.AllForms
        If frm.IsLoaded And frm.Name <> Me.Name Then
            DoCmd.Close acForm, frm.Name
        End If
    Next frm

    DoCmd.Close acForm, Me.Name

    DoCmd.OpenForm "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
End Sub

    </div>

    <div class="hidden-code" id="password-code">
        Private Sub btn–°–æ—Ö—Ä–∞–Ω–∏—Ç—å_Click()
    Dim conn As Object
    Dim rs As Object
    Dim strConn As String
    Dim strSQL As String
    Dim –°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å As String
    Dim –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å As String
    Dim –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è As String
    
    –°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å = Nz(Me.–°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å.Value, "")
    –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å = Nz(Me.–ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å.Value, "")
    –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è = Nz(Me.–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è.Value, "")

    If Trim(–°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å) = "" Or Trim(–ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å) = "" Or Trim(–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è) = "" Then
        MsgBox "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è."
        Exit Sub
    End If
    
    If –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å <> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è Then
        MsgBox "–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç."
        Exit Sub
    End If

    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"
    Set conn = CreateObject("ADODB.Connection")
    conn.Open strConn

    strSQL = "SELECT * FROM [users] WHERE login = '" & Replace(–¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω, "'", "''") & "'"
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 3

    If rs.EOF Then
        MsgBox "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω."
    ElseIf rs.Fields("password").Value <> –°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å Then
        MsgBox "–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å –≤–≤–µ–¥–µ–Ω –Ω–µ–≤–µ—Ä–Ω–æ."
    Else
        rs.Fields("password").Value = –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å
        rs.Update
        MsgBox "–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω."
        DoCmd.Close acForm, Me.Name
    End If

    rs.Close
    conn.Close
    Set rs = Nothing
    Set conn = Nothing
End Sub
Private Sub Form_Close()
    Dim conn As Object
    Dim strConn As String
    Dim updateSQL As String

    If –¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω = "" Then Exit Sub

    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"
    Set conn = CreateObject("ADODB.Connection")
    conn.Open strConn

    updateSQL = "UPDATE [users] SET account_confirmed = 1 WHERE login = '" & Replace(–¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω, "'", "''") & "'"
    conn.Execute updateSQL

    conn.Close
    Set conn = Nothing
End Sub

    </div>

    <div class="hidden-code" id="users-code">
        Private Sub login_BeforeUpdate(Cancel As Integer)
    Dim conn As Object
    Dim rs As Object
    Dim strSQL As String
    Dim –ù–æ–≤—ã–π–õ–æ–≥–∏–Ω As String

    –ù–æ–≤—ã–π–õ–æ–≥–∏–Ω = Replace(Nz(Me.login.Value, ""), "'", "''")
    If Trim(–ù–æ–≤—ã–π–õ–æ–≥–∏–Ω) = "" Then Exit Sub

    Set conn = CreateObject("ADODB.Connection")
    conn.Open "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"

    strSQL = "SELECT login FROM [users] WHERE login = '" & –ù–æ–≤—ã–π–õ–æ–≥–∏–Ω & "'"
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 1

    If Not rs.EOF Then
        MsgBox "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –í–≤–µ–¥–∏—Ç–µ –¥—Ä—É–≥–æ–π –ª–æ–≥–∏–Ω.", vbExclamation
        Cancel = True
        Me.login.Undo
    End If

    rs.Close: conn.Close
    Set rs = Nothing: Set conn = Nothing
End Sub
Private Sub is_blocked_BeforeUpdate(Cancel As Integer)
    If Me.is_blocked = False Then
        Me.last_auth_date = Date
        Me.login_attempts = 0
    End If
End Sub

        (–ì–õ–û–ë–ê–õ–¨–ù–´–ô –ú–û–î–£–õ–¨ - Public –¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω As String)
    </div>

    <script src="script.js"></script>
</body>
</html>
