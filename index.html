<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header>
        <nav>
            <div class="logo"><font id="logot">Ekb-luxury</font></div>
            <ul class="nav-links">
                <li><a href="#home">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="#about">–û –Ω–∞—Å</a></li>
                <li><a href="#services">–£—Å–ª—É–≥–∏</a></li>
                <li><a href="#gallery">–û–±—ä–µ–∫—Ç—ã</a></li>
                <li><a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
            </ul>
        </nav>
    </header>

    <!-- –ì–ª–∞–≤–Ω—ã–π –±–∞–Ω–Ω–µ—Ä -->
    <section id="home" class="hero">
        <div class="container">
            <h1>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</h1>
            <p>–ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å —É—Å–ª—É–≥ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –≤–∞—à–µ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é: –æ—Ç –ø–æ–∏—Å–∫–∞ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ –¥–æ –ø–æ–ª–Ω–æ–≥–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è</p>
            <a href="#about" class="btn">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ</a>
        </div>
    </section>

    <!-- –û –∫–æ–º–ø–∞–Ω–∏–∏ -->
    <section id="about">
        <div class="container">
            <h2>–ß—Ç–æ —Ç–∞–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥–æ–π?</h2>
            <div class="about-content">
                <div>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ - —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –≤–∞—à–µ–≥–æ –∏–º—É—â–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä–æ–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É—Å–ª—É–≥ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é –∏ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–∞–º–∏.</p>
                    <p>–ù–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 2012 –≥–æ–¥–∞ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ —á–µ–º 500 –æ–±—ä–µ–∫—Ç–∞–º–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –≤ –ú–æ—Å–∫–≤–µ –∏ –æ–±–ª–∞—Å—Ç–∏. –ú—ã –ø–æ–º–æ–≥–∞–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞–º –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –æ—Ç —Å–≤–æ–µ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Ö–ª–æ–ø–æ—Ç.</p>
                    <p>–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</p>
                    <ul style="margin-left: 20px; margin-bottom: 20px;">
                        <li>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤–∞—à–µ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</li>
                        <li>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫</li>
                        <li>–ö–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ä–µ–º–æ–Ω—Ç</li>
                        <li>–ü–æ–∏—Å–∫ –Ω–∞–¥–µ–∂–Ω—ã—Ö –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Ö –ø–ª–∞—Ç–µ–∂–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</li>
                        <li>–ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã</li>
                    </ul>
                </div>
                <div class="about-img">
                    <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3" alt="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é">
                </div>
            </div>
        </div>
    </section>

    <!-- –£—Å–ª—É–≥–∏ -->
    <section id="services" class="services">
        <div class="container">
            <h2>–ù–∞—à–∏ —É—Å–ª—É–≥–∏</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('auth-code')">üîë</div>
                    <h3>–ü–æ–¥–±–æ—Ä –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤</h3>
                    <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–±–æ—Ä –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤, –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–∫–∞–∑–æ–≤ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤</p>
                </div>
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('menu-code')">üí∞</div>
                    <h3>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</h3>
                    <p>–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–ª–∞—Ç–µ–∂–µ–π, —Ä–∞–±–æ—Ç–∞ —Å –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å—é, –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã</p>
                </div>
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('password-code')">üõ†Ô∏è</div>
                    <h3>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h3>
                    <p>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ä–µ–º–æ–Ω—Ç–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞, —Ä–µ—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–æ–±–ª–µ–º</p>
                </div>
                <div class="service-card">
                    <div class="service-icon" onclick="copyHiddenCode('users-code')">‚öñÔ∏è</div>
                    <h3>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ</h3>
                    <p>–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤, —Ä–µ—à–µ–Ω–∏–µ —Å–ø–æ—Ä–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ –≤ —Å—É–¥–µ</p>
                </div>
            </div>
        </div>
    </section>

    <!-- –ì–∞–ª–µ—Ä–µ—è -->
    <section id="gallery">
        <div class="container">
            <h2>–ù–∞—à–∏ –æ–±—ä–µ–∫—Ç—ã</h2>
            <div class="gallery-grid">
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3" alt="–ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ">
                </div>
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3" alt="–ó–∞–≥–æ—Ä–æ–¥–Ω—ã–π –¥–æ–º">
                </div>
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1605276374104-dee2a0ed3cd6?ixlib=rb-4.0.3" alt="–û—Ñ–∏—Å–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ">
                </div>
                <div class="gallery-item">
                    <img src="https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?ixlib=rb-4.0.3" alt="–¢–æ—Ä–≥–æ–≤–∞—è –ø–ª–æ—â–∞–¥—å">
                </div>
            </div>
        </div>
    </section>

    <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
    <section id="contact" style="background: linear-gradient(to right, var(--primary), var(--dark)); color: white;">
        <div class="container">
            <h2 style="color: white;">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
            <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é</p>
            <div style="margin-top: 30px;">
                <p><strong>–ê–¥—Ä–µ—Å:</strong> –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê—Ä–µ–Ω–¥–Ω–∞—è, 15</p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +7 (495) 765-43-21</p>
                <p><strong>Email:</strong> info@rentmanager.ru</p>
            </div>
            <a href="#" class="btn" style="margin-top: 30px; background: white; color: var(--primary);">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</a>
        </div>
    </section>

    
    <div class="hidden-code" id="auth-code">
Private Sub Form_Load()
    Dim conn As Object
    Dim rs As Object
    Dim strConn As String
    Dim strSQL As String
    Dim –¢–µ–∫—É—â–∞—è_–¥–∞—Ç–∞ As Date
    Dim –õ–æ–≥–∏–Ω As String
    Dim –î–∞—Ç–∞_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ As Date
    
    –¢–µ–∫—É—â–∞—è_–¥–∞—Ç–∞ = Date
    
    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"
    
    Set conn = CreateObject("ADODB.Connection")
    conn.Open strConn
    
    strSQL = "SELECT login, last_auth_date FROM [users] WHERE last_auth_date IS NOT NULL"
    
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 3
    
    Do While Not rs.EOF
        –õ–æ–≥–∏–Ω = rs.Fields("login").Value
        –î–∞—Ç–∞_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ = rs.Fields("last_auth_date").Value
        
        If –¢–µ–∫—É—â–∞—è_–¥–∞—Ç–∞ - –î–∞—Ç–∞_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ > 30 Then
            Dim updateSQL As String
            updateSQL = "UPDATE [users] SET is_blocked = 1 WHERE login = '" & Replace(–õ–æ–≥–∏–Ω, "'", "''") & "'"
            conn.Execute updateSQL
        End If
        
        rs.MoveNext
    Loop
    
    rs.Close
    conn.Close
    
    Set rs = Nothing
    Set conn = Nothing
End Sub
Private Sub –í—Ö–æ–¥_Click()
    Dim conn As Object
    Dim rs As Object
    Dim strConn As String
    Dim strSQL As String
    Dim –õ–æ–≥–∏–Ω As String
    Dim –ü–∞—Ä–æ–ª—å As String
    Dim –ü—Ä–∞–≤–∞_–¥–æ—Å—Ç—É–ø–∞ As String
    Dim –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ As Boolean
    Dim –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞ As Integer
    Dim –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è As Boolean

    –õ–æ–≥–∏–Ω = Nz(Me.–õ–æ–≥–∏–Ω.Value, "")
    –ü–∞—Ä–æ–ª—å = Nz(Me.–ü–∞—Ä–æ–ª—å.Value, "")

    If Trim(–õ–æ–≥–∏–Ω) = "" Or Trim(–ü–∞—Ä–æ–ª—å) = "" Then
        MsgBox "–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å"
        Exit Sub
    End If

    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"

    Set conn = CreateObject("ADODB.Connection")
    conn.ConnectionString = strConn
    conn.Open

    strSQL = "SELECT * FROM [users] WHERE login = '" & –õ–æ–≥–∏–Ω & "'"

    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 3

    If rs.EOF Then
        MsgBox "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω"
    Else
        –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ = Nz(rs("is_blocked"), False)
        If –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Then
            MsgBox "–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."
            rs.Close: conn.Close
            Exit Sub
        End If

        If rs("password") = –ü–∞—Ä–æ–ª—å Then
            –¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω = –õ–æ–≥–∏–Ω
            rs("login_attempts") = 0
            rs("last_auth_date") = Date
            –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è = Nz(rs("account_confirmed"), False)
            –ü—Ä–∞–≤–∞_–¥–æ—Å—Ç—É–ø–∞ = rs("access_level")

            rs.Update

            MsgBox "–í—ã —É—Å–ø–µ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª–∏—Å—å"
            If Not –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è Then
                MsgBox "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º."
                DoCmd.OpenForm "–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è"
            End If

            Select Case –ü—Ä–∞–≤–∞_–¥–æ—Å—Ç—É–ø–∞
                Case "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"
                    DoCmd.OpenForm "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
                Case "–°–æ—Ç—Ä—É–¥–Ω–∏–∫"
                    DoCmd.OpenForm "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"
                Case "–ö–ª–∏–µ–Ω—Ç"
                    DoCmd.OpenForm "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∫–ª–∏–µ–Ω—Ç–∞"
                Case Else
                    MsgBox "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
            End Select

            DoCmd.Close acForm, Me.Name
        Else
            –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞ = Nz(rs("login_attempts"), 0) + 1
            rs("login_attempts") = –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞

            If –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞ >= 3 Then
                rs("is_blocked") = True
                MsgBox "–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–∑-–∑–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫."
            Else
                MsgBox "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: " & (3 - –ü–æ–ø—ã—Ç–∫–∏–í—Ö–æ–¥–∞)
            End If

            rs.Update
        End If
    End If

    rs.Close
    conn.Close
    Set rs = Nothing
    Set conn = Nothing
End Sub
Private Sub –í—ã—Ö–æ–¥_Click()
    Dim –æ—Ç–≤–µ—Ç As Integer
    –æ—Ç–≤–µ—Ç = MsgBox("–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?", vbYesNo)
    
    If –æ—Ç–≤–µ—Ç = vbYes Then
        DoCmd.Quit
    End If
End Sub
    </div>

    <div class="hidden-code" id="menu-code">
Private Sub –í—ã—Ö–æ–¥_Click()
    Dim –æ—Ç–≤–µ—Ç As Integer
    –æ—Ç–≤–µ—Ç = MsgBox("–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?", vbYesNo)
    
    If –æ—Ç–≤–µ—Ç = vbYes Then
        DoCmd.Quit
    End If
End Sub
Private Sub –°–º–µ–Ω–∞–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è_Click()
    Dim frm As AccessObject

    For Each frm In Application.CurrentProject.AllForms
        If frm.IsLoaded And frm.Name <> Me.Name Then
            DoCmd.Close acForm, frm.Name
        End If
    Next frm

    DoCmd.Close acForm, Me.Name

    DoCmd.OpenForm "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
End Sub
    </div>

    <div class="hidden-code" id="password-code">
Private Sub btn–°–æ—Ö—Ä–∞–Ω–∏—Ç—å_Click()
    Dim conn As Object
    Dim rs As Object
    Dim strConn As String
    Dim strSQL As String
    Dim –°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å As String
    Dim –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å As String
    Dim –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è As String
    
    –°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å = Nz(Me.–°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å.Value, "")
    –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å = Nz(Me.–ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å.Value, "")
    –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è = Nz(Me.–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è.Value, "")

    If Trim(–°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å) = "" Or Trim(–ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å) = "" Or Trim(–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è) = "" Then
        MsgBox "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è."
        Exit Sub
    End If
    
    If –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å <> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–ü–∞—Ä–æ–ª—è Then
        MsgBox "–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç."
        Exit Sub
    End If

    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"
    Set conn = CreateObject("ADODB.Connection")
    conn.Open strConn

    strSQL = "SELECT * FROM [users] WHERE login = '" & Replace(–¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω, "'", "''") & "'"
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 3

    If rs.EOF Then
        MsgBox "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω."
    ElseIf rs.Fields("password").Value <> –°—Ç–∞—Ä—ã–π–ü–∞—Ä–æ–ª—å Then
        MsgBox "–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å –≤–≤–µ–¥–µ–Ω –Ω–µ–≤–µ—Ä–Ω–æ."
    Else
        rs.Fields("password").Value = –ù–æ–≤—ã–π–ü–∞—Ä–æ–ª—å
        rs.Update
        MsgBox "–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω."
        DoCmd.Close acForm, Me.Name
    End If

    rs.Close
    conn.Close
    Set rs = Nothing
    Set conn = Nothing
End Sub
Private Sub Form_Close()
    Dim conn As Object
    Dim strConn As String
    Dim updateSQL As String

    If –¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω = "" Then Exit Sub

    strConn = "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"
    Set conn = CreateObject("ADODB.Connection")
    conn.Open strConn

    updateSQL = "UPDATE [users] SET account_confirmed = 1 WHERE login = '" & Replace(–¢–µ–∫—É—â–∏–π–õ–æ–≥–∏–Ω, "'", "''") & "'"
    conn.Execute updateSQL

    conn.Close
    Set conn = Nothing
End Sub
    </div>

    <div class="hidden-code" id="users-code">
Private Sub login_BeforeUpdate(Cancel As Integer)
    Dim conn As Object
    Dim rs As Object
    Dim strSQL As String
    Dim –ù–æ–≤—ã–π–õ–æ–≥–∏–Ω As String

    –ù–æ–≤—ã–π–õ–æ–≥–∏–Ω = Replace(Nz(Me.login.Value, ""), "'", "''")
    If Trim(–ù–æ–≤—ã–π–õ–æ–≥–∏–Ω) = "" Then Exit Sub

    Set conn = CreateObject("ADODB.Connection")
    conn.Open "Provider=SQLOLEDB;Data Source=DO_ZAVRTA\MS;Initial Catalog=HotelSystem;Integrated Security=SSPI;"

    strSQL = "SELECT login FROM [users] WHERE login = '" & –ù–æ–≤—ã–π–õ–æ–≥–∏–Ω & "'"
    Set rs = CreateObject("ADODB.Recordset")
    rs.Open strSQL, conn, 1, 1

    If Not rs.EOF Then
        MsgBox "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –í–≤–µ–¥–∏—Ç–µ –¥—Ä—É–≥–æ–π –ª–æ–≥–∏–Ω.", vbExclamation
        Cancel = True
        Me.login.Undo
    End If

    rs.Close: conn.Close
    Set rs = Nothing: Set conn = Nothing
End Sub
Private Sub is_blocked_BeforeUpdate(Cancel As Integer)
    If Me.is_blocked = False Then
        Me.last_auth_date = Date
        Me.login_attempts = 0
    End If
End Sub
    </div>

    <script src="script.js"></script>
</body>
</html>
